<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - Prashant Baral</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .logo-font {
            font-family: 'Dancing Script', cursive;
            padding-right: 10px;
        }

        body {
            background-color: #f1f5f9;
            font-family: 'Inter', sans-serif;
        }

        .blog-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }
    </style>
</head>

<body class="bg-slate-50">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 w-full z-50 py-4 px-8 bg-white border-b border-slate-200">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <a href="index.html"
                class="logo-font font-bold text-3xl italic bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                Prashant Baral
            </a>
            <ul class="hidden md:flex items-center space-x-8">
                <li><a href="about.html" class="text-sm font-medium text-slate-600 hover:text-blue-600">about.</a></li>
                <li><a href="projects.html" class="text-sm font-medium text-slate-600 hover:text-blue-600">projects.</a>
                </li>
                <li><a href="portfolio.html"
                        class="text-sm font-medium text-slate-600 hover:text-blue-600">portfolio.</a></li>
                <li><a href="blogs.html" class="text-sm font-medium text-blue-600">blogs.</a></li>
                <li><a href="contact.html" class="text-sm font-medium text-slate-600 hover:text-blue-600">contact.</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-32 pb-16 px-4 md:px-8">
        <div class="max-w-7xl mx-auto text-center">
            <h1 class="text-5xl md:text-6xl font-bold text-slate-900 mb-4">
                Blog <span class="text-blue-600">Posts</span>
            </h1>
            <p class="text-xl text-slate-600 max-w-2xl mx-auto">
                Thoughts, tutorials, and insights about web development, backend engineering, and technology.
            </p>
        </div>
    </section>

    <!-- Blog Posts Grid -->
    <section class="py-16 px-4 md:px-8">
        <div class="max-w-7xl mx-auto">
            <!-- Loading State -->
            <div id="loading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Skeleton Cards -->
                <div class="bg-white rounded-xl overflow-hidden">
                    <div class="skeleton h-48"></div>
                    <div class="p-6">
                        <div class="skeleton h-6 mb-4 rounded"></div>
                        <div class="skeleton h-4 mb-2 rounded"></div>
                        <div class="skeleton h-4 w-2/3 rounded"></div>
                    </div>
                </div>
                <div class="bg-white rounded-xl overflow-hidden">
                    <div class="skeleton h-48"></div>
                    <div class="p-6">
                        <div class="skeleton h-6 mb-4 rounded"></div>
                        <div class="skeleton h-4 mb-2 rounded"></div>
                        <div class="skeleton h-4 w-2/3 rounded"></div>
                    </div>
                </div>
                <div class="bg-white rounded-xl overflow-hidden">
                    <div class="skeleton h-48"></div>
                    <div class="p-6">
                        <div class="skeleton h-6 mb-4 rounded"></div>
                        <div class="skeleton h-4 mb-2 rounded"></div>
                        <div class="skeleton h-4 w-2/3 rounded"></div>
                    </div>
                </div>
            </div>

            <!-- Blog Posts Container -->
            <div id="blogPosts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" style="display: none;">
            </div>

            <!-- No Posts Message -->
            <div id="noPosts" class="text-center py-16" style="display: none;">
                <div class="text-6xl mb-4">üìù</div>
                <h3 class="text-2xl font-bold text-slate-900 mb-2">No blog posts yet</h3>
                <p class="text-slate-600">Check back soon for new content!</p>
            </div>

            <!-- Error Message -->
            <div id="error" class="text-center py-16" style="display: none;">
                <div class="text-6xl mb-4">‚ö†Ô∏è</div>
                <h3 class="text-2xl font-bold text-slate-900 mb-2">Failed to load posts</h3>
                <p class="text-slate-600 mb-4">There was an error loading the blog posts.</p>
                <button onclick="loadBlogPosts()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    Try Again
                </button>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 py-8 px-4 md:px-8 mt-16">
        <div class="max-w-7xl mx-auto text-center">
            <p class="text-slate-600">&copy; 2024 Prashant Baral. All rights reserved.</p>
        </div>
    </footer>

    <script>
        async function loadBlogPosts() {
            const loading = document.getElementById('loading');
            const blogPosts = document.getElementById('blogPosts');
            const noPosts = document.getElementById('noPosts');
            const error = document.getElementById('error');

            try {
                // Show loading state
                loading.style.display = 'grid';
                blogPosts.style.display = 'none';
                noPosts.style.display = 'none';
                error.style.display = 'none';

                // Fetch the list of blog posts from GitHub
                const response = await fetch('https://api.github.com/repos/Prashant-Baral/portfolio-website/contents/content/blog');

                if (!response.ok) {
                    throw new Error('Failed to fetch blog posts');
                }

                const files = await response.json();

                // Filter only markdown files
                const mdFiles = files.filter(file => file.name.endsWith('.md'));

                if (mdFiles.length === 0) {
                    loading.style.display = 'none';
                    noPosts.style.display = 'block';
                    return;
                }

                // Fetch content of each blog post
                const posts = await Promise.all(
                    mdFiles.map(async (file) => {
                        const contentResponse = await fetch(file.download_url);
                        const content = await contentResponse.text();
                        return parseBlogPost(content, file.name);
                    })
                );

                // Sort posts by date (newest first)
                posts.sort((a, b) => new Date(b.date) - new Date(a.date));

                // Display posts
                displayBlogPosts(posts);

                loading.style.display = 'none';
                blogPosts.style.display = 'grid';

            } catch (err) {
                console.error('Error loading blog posts:', err);
                loading.style.display = 'none';
                error.style.display = 'block';
            }
        }

        function parseBlogPost(content, filename) {
            // Parse frontmatter
            const frontmatterMatch = content.match(/^---\n([\s\S]+?)\n---\n([\s\S]*)$/);

            if (!frontmatterMatch) {
                return null;
            }

            const frontmatter = {};
            const lines = frontmatterMatch[1].split('\n');

            lines.forEach(line => {
                const colonIndex = line.indexOf(':');
                if (colonIndex > -1) {
                    const key = line.substring(0, colonIndex).trim();
                    let value = line.substring(colonIndex + 1).trim();
                    value = value.replace(/^["']|["']$/g, '');
                    frontmatter[key] = value;
                }
            });

            const body = frontmatterMatch[2];
            const slug = filename.replace('.md', '');

            return {
                title: frontmatter.title || 'Untitled',
                date: frontmatter.date || new Date().toISOString(),
                excerpt: frontmatter.excerpt || body.substring(0, 150) + '...',
                author: frontmatter.author || 'Prashant Baral',
                image: frontmatter.image || 'https://via.placeholder.com/400x250',
                tags: frontmatter.tags ? frontmatter.tags.split(',').map(t => t.trim()) : [],
                slug: slug
            };
        }

        function displayBlogPosts(posts) {
            const container = document.getElementById('blogPosts');
            container.innerHTML = '';

            posts.forEach(post => {
                if (!post) return;

                const card = document.createElement('div');
                card.className = 'blog-card bg-white rounded-xl overflow-hidden shadow-lg';

                const dateObj = new Date(post.date);
                const formattedDate = dateObj.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                card.innerHTML = `
                    <img src="${post.image}" alt="${post.title}" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <div class="flex items-center text-sm text-slate-500 mb-3">
                            <i class="far fa-calendar mr-2"></i>
                            <span>${formattedDate}</span>
                            <span class="mx-2">‚Ä¢</span>
                            <span>${post.author}</span>
                        </div>
                        <h3 class="text-xl font-bold text-slate-900 mb-2 line-clamp-2">${post.title}</h3>
                        <p class="text-slate-600 mb-4 line-clamp-3">${post.excerpt}</p>
                        ${post.tags.length > 0 ? `
                            <div class="flex flex-wrap gap-2 mb-4">
                                ${post.tags.map(tag => `
                                    <span class="px-3 py-1 bg-blue-100 text-blue-600 text-xs rounded-full">${tag}</span>
                                `).join('')}
                            </div>
                        ` : ''}
                        <a href="blog-post.html?post=${post.slug}" class="inline-flex items-center text-blue-600 font-semibold hover:text-blue-700">
                            Read More 
                            <i class="fas fa-arrow-right ml-2"></i>
                        </a>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // Load posts when page loads
        document.addEventListener('DOMContentLoaded', loadBlogPosts);
    </script>
</body>

</html>